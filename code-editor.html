<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>åœ¨çº¿ä»£ç é¢„è§ˆå™¨</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Arial;background:#1e1e1e;color:#d4d4d4;height:100vh;display:flex;flex-direction:column}
.header{background:#007acc;color:white;padding:15px;text-align:center}
.container{display:flex;flex:1;overflow:hidden}
.editor-panel{flex:1;display:flex;flex-direction:column;border-right:1px solid #333}
.preview-panel{flex:1;display:flex;flex-direction:column}
.panel-header{background:#252526;padding:10px;border-bottom:1px solid #333;display:flex;justify-content:space-between;align-items:center}
textarea{flex:1;background:#1e1e1e;color:#d4d4d4;border:none;padding:15px;font-family:'Consolas','Monaco',monospace;font-size:14px;resize:none;outline:none}
#iframePreview{flex:1;border:none;background:white}
.button{background:#0e639c;color:white;border:none;padding:8px 15px;border-radius:3px;cursor:pointer;margin-left:10px}
.button:hover{background:#1177bb}
.select{background:#3c3c3c;color:white;border:1px solid #007acc;padding:5px;border-radius:3px}
.controls{padding:10px;background:#252526;border-top:1px solid #333}

/* æ–°å¢ï¼šç¼–è¾‘å™¨è¡Œå· */
.editor-wrapper{display:flex;flex:1;overflow:hidden}
.line-numbers{background:#2d2d2d;color:#858585;padding:15px 5px;font-family:'Consolas','Monaco',monospace;font-size:14px;line-height:1.5;text-align:right;user-select:none;overflow:hidden}
.line-numbers div{padding-right:10px}

/* æ–°å¢ï¼šçŠ¶æ€æ  */
.status-bar{background:#007acc;color:white;padding:5px 15px;font-size:12px;display:flex;justify-content:space-between}

/* æ–°å¢ï¼šé”™è¯¯æç¤º */
.error-toast{position:fixed;bottom:20px;right:20px;background:#f44336;color:white;padding:15px;border-radius:5px;box-shadow:0 4px 12px rgba(0,0,0,0.3);display:none;z-index:1000}
.error-toast.show{display:block}
</style>
</head>
<body>
<div class="header">
<h2>ğŸ› ï¸ åœ¨çº¿ä»£ç é¢„è§ˆå™¨</h2>
<p>ç¼–è¾‘ä»£ç ï¼Œå®æ—¶æŸ¥çœ‹æ•ˆæœï¼ˆæ”¯æŒHTML/CSS/JSï¼‰</p>
</div>

<div class="container">
<div class="editor-panel">
<div class="panel-header">
<span>ğŸ“ ä»£ç ç¼–è¾‘å™¨</span>
<select id="codeType" class="select">
<option value="html">HTML ä»£ç </option>
<option value="css">CSS ä»£ç </option>
<option value="js">JavaScript ä»£ç </option>
<option value="full">å®Œæ•´ç½‘é¡µ</option>
</select>
</div>
<div class="editor-wrapper">
<div class="line-numbers" id="lineNumbers">1</div>
<textarea id="codeInput" placeholder="åœ¨è¿™é‡Œè¾“å…¥ä½ çš„ä»£ç ...">
<!DOCTYPE html>
<html>
<head>
    <title>æˆ‘çš„æµ‹è¯•é¡µé¢</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .demo-box { 
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white; 
            padding: 30px; 
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }
        button { 
            background: #4CAF50; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="demo-box">
        <h1>ä½ å¥½ï¼è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹</h1>
        <p>ç¼–è¾‘å·¦ä¾§ä»£ç ï¼Œå³ä¾§ä¼šå®æ—¶å˜åŒ–</p>
        <button onclick="showMessage()">ç‚¹å‡»æµ‹è¯•</button>
        <p id="currentTime"></p>
    </div>
    
    <script>
        function showMessage() {
            alert('JavaScript è¿è¡Œæ­£å¸¸ï¼');
        }
        
        // å®æ—¶æ˜¾ç¤ºæ—¶é—´
        function updateTime() {
            const timeElement = document.getElementById('currentTime');
            if(timeElement) {
                timeElement.textContent = new Date().toLocaleString('zh-CN');
            }
        }
        setInterval(updateTime, 1000);
        updateTime();
    </script>
</body>
</html>
</textarea>
</div>
<div class="status-bar" id="editorStatus">
<span>è¡Œ: 1, åˆ—: 1</span>
<span id="charCount">0 å­—ç¬¦</span>
</div>
</div>

<div class="preview-panel">
<div class="panel-header">
<span>ğŸ‘ï¸ å®æ—¶é¢„è§ˆ</span>
<div>
<button class="button" onclick="runCode()">â–¶ï¸ è¿è¡Œä»£ç </button>
<button class="button" onclick="saveCode()">ğŸ’¾ ä¿å­˜ä»£ç </button>
<button class="button" onclick="loadExample()">ğŸ“‹ åŠ è½½ç¤ºä¾‹</button>
<button class="button" onclick="clearCode()">ğŸ—‘ï¸ æ¸…ç©º</button>
</div>
</div>
<iframe id="iframePreview" sandbox="allow-scripts allow-same-origin"></iframe>
<div class="status-bar">
<span id="previewStatus">å°±ç»ª</span>
<span id="lastRun">-</span>
</div>
</div>
</div>

<div class="controls">
<label style="margin-right:15px;">
<input type="checkbox" id="autoRefresh" checked> è‡ªåŠ¨åˆ·æ–°
</label>
<label style="margin-right:15px;">
<input type="checkbox" id="lineNumbersToggle" checked> æ˜¾ç¤ºè¡Œå·
</label>
<select id="refreshRate" style="background:#3c3c3c;color:white;border:1px solid #007acc;padding:5px;border-radius:3px;margin-left:10px">
<option value="500">åˆ·æ–°å»¶è¿Ÿ: 0.5ç§’</option>
<option value="1000" selected>åˆ·æ–°å»¶è¿Ÿ: 1ç§’</option>
<option value="2000">åˆ·æ–°å»¶è¿Ÿ: 2ç§’</option>
<option value="5000">åˆ·æ–°å»¶è¿Ÿ: 5ç§’</option>
</select>
<span style="color:#888;margin-left:20px;">æç¤ºï¼šè¾“å…¥ä»£ç åé¢„è§ˆä¼šè‡ªåŠ¨æ›´æ–°ï¼ˆå¦‚æœå¯ç”¨äº†è‡ªåŠ¨åˆ·æ–°ï¼‰</span>
</div>

<div class="error-toast" id="errorToast">é”™è¯¯ä¿¡æ¯</div>

<script>
const codeInput=document.getElementById('codeInput');
const iframePreview=document.getElementById('iframePreview');
const codeTypeSelect=document.getElementById('codeType');
const autoRefreshCheckbox=document.getElementById('autoRefresh');
const lineNumbers=document.getElementById('lineNumbers');
const lineNumbersToggle=document.getElementById('lineNumbersToggle');
const refreshRateSelect=document.getElementById('refreshRate');
const editorStatus=document.getElementById('editorStatus');
const charCount=document.getElementById('charCount');
const previewStatus=document.getElementById('previewStatus');
const lastRun=document.getElementById('lastRun');
const errorToast=document.getElementById('errorToast');

let autoRefreshTimer;
let lastRunTime=null;

// æ›´æ–°è¡Œå·
function updateLineNumbers(){
    if(!lineNumbersToggle.checked){
        lineNumbers.style.display='none';
        return;
    }
    lineNumbers.style.display='block';
    const lines=codeInput.value.split('\n').length;
    lineNumbers.innerHTML='';
    for(let i=1;i<=lines;i++){
        const lineDiv=document.createElement('div');
        lineDiv.textContent=i;
        lineNumbers.appendChild(lineDiv);
    }
}

// æ›´æ–°å…‰æ ‡ä½ç½®
function updateCursorPosition(){
    const cursorPos=codeInput.selectionStart;
    const textBeforeCursor=codeInput.value.substring(0,cursorPos);
    const line=textBeforeCursor.split('\n').length;
    const column=textBeforeCursor.split('\n').pop().length+1;
    editorStatus.children[0].textContent=`è¡Œ: ${line}, åˆ—: ${column}`;
}

// æ›´æ–°å­—ç¬¦ç»Ÿè®¡
function updateCharCount(){
    const count=codeInput.value.length;
    charCount.textContent=`${count} å­—ç¬¦`;
}

// è¿è¡Œä»£ç 
function runCode(){
    try{
        const code=codeInput.value;
        const type=codeTypeSelect.value;
        let fullHTML='';
        
        if(type==='full'){
            fullHTML=code;
        }else if(type==='html'){
            fullHTML=`<!DOCTYPE html><html><head><style>body{font-family:Arial;padding:20px}</style></head><body>${code}</body></html>`;
        }else if(type==='css'){
            fullHTML=`<!DOCTYPE html><html><head><style>${code}</style></head><body><div class="demo">CSSæ•ˆæœé¢„è§ˆ</div></body></html>`;
        }else if(type==='js'){
            fullHTML=`<!DOCTYPE html><html><head></head><body><script>try{${code}}catch(e){document.body.innerHTML='<div style="color:red;padding:20px">é”™è¯¯: '+e.message+'</div>'}<\\/script><div id="output"></div></body></html>`;
        }
        
        iframePreview.srcdoc=fullHTML;
        previewStatus.textContent='è¿è¡ŒæˆåŠŸ';
        lastRunTime=new Date();
        lastRun.textContent=lastRunTime.toLocaleTimeString('zh-CN');
        
        // éšè—é”™è¯¯æç¤º
        errorToast.classList.remove('show');
    }catch(error){
        showError(`è¿è¡Œé”™è¯¯: ${error.message}`);
    }
}

// æ˜¾ç¤ºé”™è¯¯æç¤º
function showError(message){
    errorToast.textContent=message;
    errorToast.classList.add('show');
    setTimeout(()=>{
        errorToast.classList.remove('show');
    },5000);
}

// ä¿å­˜ä»£ç åˆ°æœ¬åœ°å­˜å‚¨
function saveCode(){
    try{
        const code=codeInput.value;
        const type=codeTypeSelect.value;
        const key=`savedCode_${type}`;
        localStorage.setItem(key,code);
        previewStatus.textContent='ä¿å­˜æˆåŠŸ';
        showError('âœ… ä»£ç å·²ä¿å­˜åˆ°æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ï¼');
    }catch(error){
        showError(`ä¿å­˜å¤±è´¥: ${error.message}`);
    }
}

// åŠ è½½ç¤ºä¾‹ä»£ç 
function loadExample(){
    const examples={
        html:`<h1>æ¬¢è¿ä½¿ç”¨é¢„è§ˆå™¨</h1>
<p>è¿™æ˜¯ä¸€ä¸ªHTMLç¤ºä¾‹</p>
<ul>
    <li>åˆ—è¡¨é¡¹ 1</li>
    <li>åˆ—è¡¨é¡¹ 2</li>
    <li>åˆ—è¡¨é¡¹ 3</li>
</ul>
<div style="margin-top:20px">
    <button onclick="alert('Hello!')">ç‚¹å‡»æˆ‘</button>
</div>`,
        css:`body {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    font-family: Arial;
    padding: 40px;
}

.button {
    background: #4CAF50;
    color: white;
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s;
}

.button:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

.container {
    max-width: 1200px;
    margin: 0 auto;
}

.card {
    background: rgba(255,255,255,0.1);
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
}`,
        js:`// JavaScriptç¤ºä¾‹
console.log('ä»£ç å¼€å§‹æ‰§è¡Œ');

// åˆ›å»ºä¸€ä¸ªè®¡æ•°å™¨
let count = 0;

function updateCounter() {
    count++;
    document.getElementById('counter').textContent = 'ç‚¹å‡»æ¬¡æ•°: ' + count;
}

// åˆ›å»ºç•Œé¢
document.body.innerHTML = \`
    <div style="text-align:center;padding:40px;">
        <h1>JavaScript æ¼”ç¤º</h1>
        <p id="counter">ç‚¹å‡»æ¬¡æ•°: 0</p>
        <button onclick="updateCounter()" style="margin:5px">ç‚¹å‡»æˆ‘</button>
        <button onclick="count=0;updateCounter()" style="margin:5px">é‡ç½®</button>
        <button onclick="alert('å½“å‰è®¡æ•°: ' + count)" style="margin:5px">æ˜¾ç¤ºè®¡æ•°</button>
    </div>
\`;

// è‡ªåŠ¨æ›´æ–°æ˜¾ç¤º
updateCounter();`,
        full:`<!DOCTYPE html>
<html>
<head>
    <title>å®Œæ•´ç¤ºä¾‹</title>
    <style>
        body {
            font-family: 'Segoe UI', 
