<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Ê¨¢ËøéËÆøÈóÆ</title>
                <style>
                        *{margin:0;padding:0;box-sizing:border-box}
                                body{font-family:Arial;background:linear-gradient(135deg,#1a2a6c,#b21f1f,#fdbb2d);color:white;min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px}
                                        .container{background:rgba(255,255,255,0.15);padding:40px;border-radius:20px;text-align:center;max-width:500px;width:90%;backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.2)}
                                                .emoji{font-size:4em;margin:15px 0}
                                                        .btn{background:linear-gradient(45deg,#FF416C,#FF4B2B);color:white;border:none;padding:15px 30px;font-size:1.1em;border-radius:50px;cursor:pointer;margin:10px;width:calc(100% - 20px);font-weight:bold;transition:transform 0.2s}
                                                                .btn:hover{transform:scale(1.05)}
                                                                        .btn-secondary{background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.3)}
                                                                                input,textarea{width:100%;padding:12px;margin:10px 0;border:none;border-radius:8px;font-size:16px;background:rgba(255,255,255,0.9)}
                                                                                        textarea{height:80px;resize:vertical}
                                                                                                .loading{display:none;margin:10px 0;color:rgba(255,255,255,0.8)}
                                                                                                    </style>
                                                                                                    </head>
                                                                                                    <body>
                                                                                                        <div class="container">
                                                                                                                <div class="emoji">üëã</div>
                                                                                                                        <h1>Ê¨¢ËøéËÆøÈóÆÔºÅ</h1>
                                                                                                                                <p>Âú®ÂºÄÂßãÊ∏∏ÊàèÂâçËØ∑ÂÖàÁôªËÆ∞</p>
                                                                                                                                        <div style="margin:25px 0">
                                                                                                                                                    <input type="text" id="visitorName" placeholder="‰Ω†ÁöÑÂêçÂ≠óÔºàÂèØÈÄâÔºâ">
                                                                                                                                                                <textarea id="visitorNote" placeholder="ÁïôË®ÄÔºàÂèØÈÄâÔºâ"></textarea>
                                                                                                                                                                            <div class="loading" id="loadingIndicator">üöÄ Êèê‰∫§‰∏≠ÔºåËØ∑Á®çÂÄô...</div>
                                                                                                                                                                                        <button class="btn" onclick="registerAndRedirect()" id="submitBtn">üöÄ ÁôªËÆ∞Âπ∂ÂºÄÂßãÊ∏∏Êàè</button>
                                                                                                                                                                                                    <button class="btn btn-secondary" onclick="skipToGame()">‚è© Ë∑≥ËøáÁõ¥Êé•Ê∏∏Êàè</button>
                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                </div>

                                                                                                                                                                                                                    <script src="visitor-log.js"></script>
                                                                                                                                                                                                                        <script>
                                                                                                                                                                                                                                function recordVisit(action,data={}){
                                                                                                                                                                                                                                                const visitData={action,timestamp:new Date().toISOString(),...data};
                                                                                                                                                                                                                                                            console.log('üìù ËÆøÈóÆËÆ∞ÂΩï:',visitData);
                                                                                                                                                                                                                                                                        if(action==='user_registration'||action==='skip_registration'){
                                                                                                                                                                                                                                                                                            registerVisitor(data.userName||'ÂåøÂêçÁî®Êà∑',data.userNote||'Êó†ÁïôË®Ä');
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                    sendToCloud(visitData);
                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                        async function sendToCloud(data){
                                                                                                                                                                                                                                                        try{
                                                                                                                                                                                                                                                                            const response=await fetch('https://fsywed-github-lo-ylkz.vercel.app/api/save-message',{
                                                                                                                                                                                                                                                                                                    method:'POST',headers:{'Content-Type':'application/json'},
                                                                                                                                                                                                                                                                                                                        body:JSON.stringify({
                                                                                                                                                                                                                                                                                                                                                    name:data.userName||'Á≥ªÁªüËÆ∞ÂΩï',
                                                                                                                                                                                                                                                                                                                                                                            message:data.userNote||`Âä®‰Ωú:${data.action}`,
                                                                                                                                                                                                                                                                                                                                                                                                    timestamp:data.timestamp,action:data.action
                                                                                                                                                                                                                                                                                                                        })
                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                            if(response.ok) console.log('‚úÖ ‰∫ëÁ´ØËÆ∞ÂΩïÊàêÂäü');
                                                                                                                                                                                                                                                                                                            else console.log('‚ö†Ô∏è ‰∫ëÁ´ØËÆ∞ÂΩïÂ§±Ë¥•:',response.status);
                                                                                                                                                                                                                                                        }catch(error){console.log('üåê ÁΩëÁªúÈîôËØØ:',error);}
                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                window.addEventListener('load',()=>recordVisit('homepage_visit'));

                                                                                                                                                                                                                                                        async function registerAndRedirect(){
                                                                                                                                                                                                                                                                        const name=document.getElementById('visitorName').value.trim();
                                                                                                                                                                                                                                                                                    const note=document.getElementById('visitorNote').value.trim();
                                                                                                                                                                                                                                                                                                const userName=name||'ÂåøÂêçÁî®Êà∑';
                                                                                                                                                                                                                                                                                                            const userNote=note||'Êó†ÁïôË®Ä';
                                                                                                                                                                                                                                                                                                                        showLoading(true);
                                                                                                                                                                                                                                                                                                                                    try{
                                                                                                                                                                                                                                                                                                                                                        await recordVisit('user_registration',{userName,userNote,hasName:!!name,hasNote:!!note});
                                                                                                                                                                                                                                                                                                                                                                        setTimeout(()=>window.location.href='game.html',500);
                                                                                                                                                                                                                                                                                                                                    }catch(error){
                                                                                                                                                                                                                                                                                                                                                        console.error('ÁôªËÆ∞Â§±Ë¥•:',error);
                                                                                                                                                                                                                                                                                                                                                                        showLoading(false);
                                                                                                                                                                                                                                                                                                                                                                                        alert('ÁôªËÆ∞Â§±Ë¥•Ôºå‰ΩÜÊÇ®‰ªçÁÑ∂ÂèØ‰ª•ÁªßÁª≠Ê∏∏Êàè');
                                                                                                                                                                                                                                                                                                                                                                                                        window.location.href='game.html';
                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                        function skipToGame(){
                                                                                                                                                                                                                                                                                        recordVisit('skip_registration',{userName:'ÂåøÂêçË∑≥ËøáÁî®Êà∑',userNote:'Áî®Êà∑ÈÄâÊã©Ë∑≥ËøáÁôªËÆ∞',isSkipped:true});
                                                                                                                                                                                                                                                                                                    window.location.href='game.html';
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                        function showLoading(show){
                                                                                                                                                                                                                                                                                                        const loading=document.getElementById('loadingIndicator');
                                                                                                                                                                                                                                                                                                                    const submitBtn=document.getElementById('submitBtn');
                                                                                                                                                                                                                                                                                                                                loading.style.display=show?'block':'none';
                                                                                                                                                                                                                                                                                                                                            submitBtn.disabled=show;
                                                                                                                                                                                                                                                                                                                                                        submitBtn.textContent=show?'Êèê‰∫§‰∏≠...':'üöÄ ÁôªËÆ∞Âπ∂ÂºÄÂßãÊ∏∏Êàè';
                                                                                                                                                                                                                                                                                                                                                                    submitBtn.style.opacity=show?'0.7':'1';
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                        document.addEventListener('keypress',(e)=>e.key==='Enter'&&registerAndRedirect());
                                                                                                                                                                                                                                                                                                                window.addEventListener('load',()=>document.getElementById('visitorName').focus());
                                                                                                                                                                                                                                                                                                                    </script>
                                                                                                                                                                                                                                                                                                                    </body>
                                                                                                                                                                                                                                                                                                                    </html>
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                        })
                                                                                                                                                                                                                                                                            })
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                }